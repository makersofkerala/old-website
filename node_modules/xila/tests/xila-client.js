const http = require('http');

const parseBody = (url, fn) => {

    return new Promise((res, rej) => {

	http.get(url, resp => {

	    let body = "";
	    
	    resp.setEncoding("utf8");

	    resp.on("error", err => rej(err));

	    resp.on("data", data => { body += data; });

	    resp.on("end", () => { body = fn(body); res(body); });

	});

    });
}

async function body(url) { return parseBody(url, x => x); }

async function json(url) { return parseBody(url, JSON.parse); }

module.exports = {body, json};
